<%- include("../user/layouts/user_header.ejs") %>

<style>

    .table th{
         font-size: medium;
         color: aliceblue;
    }
    .table tbody td{
        font-size: small;
        font-weight: 500;
    }
    
</style>

<main class="main">
    <div class="page-header text-center" style="background-color: rgb(0, 0, 0);;">
        <div class="container">
          <h3 style="font-weight: 1000 "><Span style="color: rgb(46, 202, 88);">Eco</Span> <span style="color: aliceblue;">Bikes</span> </h3>
        </div><!-- End .container -->
    </div><!-- End .page-header -->
    <nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Shop</a></li>
                <li class="breadcrumb-item active" aria-current="page">My Account</li>
            </ol>
        </div><!-- End .container -->
    </nav><!-- End .breadcrumb-nav -->

    <div class="page-content">
        <div class="dashboard">
            <div class="container">
                <div class="row">
                    <aside class="col-md-4 col-lg-3">
                        <ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="tab-dashboard-link" data-toggle="tab" href="#tab-dashboard" role="tab" aria-controls="tab-dashboard" aria-selected="true">Profile</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="tab-orders-link"  href="./orderList" role="tab" aria-controls="tab-orders" aria-selected="false">Orders</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="tab-address-link" href="./loadaddAddressFromDash">Add New Adresses</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="./logout">Sign Out</a>
                            </li>
                        </ul>
                    </aside><!-- End .col-lg-3 -->

                    <div class="col-md-8 col-lg-9">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="tab-dashboard" role="tabpanel" aria-labelledby="tab-dashboard-link">
                                <p>Hello <%  if(session != null){ %><span class="font-weight-normal text-dark"><%= user.user_name %></span><% }else{ %> (<span class="font-weight-normal text-dark">User</span>? <a href="/login">Log In</a>)<%}%>
   
                                <!-- <p>email <span class="font-weight-normal text-dark"></span> </p> -->
                                <p>Email id: <span class="font-weight-normal text-dark"><%= user.email %></span></p>
                                <p>Wallet Balence: <span  style="color: rgb(61, 59, 59);"><%= user.wallet %>/-</span></p>
                                
                          <a href="" data-toggle="modal" data-target="#modalContactForm"><button  class="btn btn-outline-primary btn-rounded" type="button" style="color: black; border-color:rgb(46, 202, 88) ;"> Edit user details</button></a>
                            
                                <a href="/loadUserAddressFromDash"><button  class="btn btn-outline-primary btn-rounded" type="button" style="color: black; border-color:rgb(46, 202, 88) ;"> My addresss</button></a>
                              
                            </div><!-- .End .tab-pane -->
                   

                            <div class="tab-pane fade" id="tab-orders" role="tabpanel" aria-labelledby="tab-orders-link" style="background-color: rgb(34, 209, 86);" >
                                  <br>
                                
                              
                                <a href="/shop" class="btn btn-outline-primary btn-rounded"><span style="color: rgb(0, 0, 0); float: right;" >GO SHOP</span><i class="icon-long-arrow-right"></i></a>
                            </div><!-- .End .tab-pane -->

                            <div class="tab-pane fade" id="tab-downloads" role="tabpanel" aria-labelledby="tab-downloads-link">
                                <p>No downloads available yet.</p>
                                <a href="/shop" class="btn btn-outline-primary-2"><span>GO SHOP</span><i class="icon-long-arrow-right"></i></a>
                            </div><!-- .End .tab-pane -->
                       
                            <div class="tab-pane fade" id="tab-address" role="tabpanel" aria-labelledby="tab-address-link">
                                <p>The following addresses will be used on the checkout page by default.</p>

                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="card card-dashboard">
                                            <div class="card-body">
                                          
                                               
                                            </div><!-- End .card-body -->
                                        </div><!-- End .card-dashboard -->
                                    </div><!-- End .col-lg-6 -->

                                    <div class="col-lg-6">
                                        <div class="card card-dashboard">
                                            <div class="card-body">
                                                <h3 class="card-title">Shipping Address</h3><!-- End .card-title -->

                                                <p>You have not set up this type of address yet.<br>
                                                <a href="#">Edit <i class="icon-edit"></i></a></p>
                                            </div><!-- End .card-body -->
                                        </div><!-- End .card-dashboard -->
                                    </div><!-- End .col-lg-6 -->
                                </div><!-- End .row -->
                            </div><!-- .End .tab-pane -->
                        </div>
                    </div><!-- End .col-lg-9 -->
                </div><!-- End .row -->
            </div><!-- End .container -->
        </div><!-- End .dashboard -->
    </div><!-- End .page-content -->
     

 <div class="modal fade" id="modalContactForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <div  id="error" style="color: red;"></div>
        <form action="/editUser/<%= user._id %>" method="post"  id="form">
        <h4 class="modal-title w-100 font-weight-bold"> <span style="color: rgb(46, 202, 88);">Edit</span> user details</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
            <label data-error="wrong" data-success="right" for="form34">Your name</label>
          <input type="text" id="name" name="name" class="form-control validate" value="<%= user.user_name %>" required>
        </div>

        <div class="md-form mb-5">
         
            <label data-error="wrong" data-success="right" for="form29">Your email</label>
          <input type="email" name="email" id="email" class="form-control validate" value="<%= user.email %>" required>
        </div>

        <div class="md-form mb-5">
        
            <label data-error="wrong" data-success="right" for="form32">Mobile number</label>
          <input type="text" name="mobile" id="mobile" max="10" min="10" class="form-control validate" value="<%= user.mobile_number %>" required>
        </div>
       

      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button type="submit" class="btn btn-unique">Submit <i class="fas fa-paper-plane-o ml-1"></i></button>
      </div>
    </form>
    </div>
  </div>
</div>

</main><!-- End .main -->

<script>


    const name = document.getElementById('name');
    const mob = document.getElementById('mobile');
    const  email  = document.getElementById('email')
    const  form  = document.getElementById('form')
    const errorElement = document.getElementById("error")

    form.addEventListener('submit',(e)=>{
    let messages = []
    if(  name.value.trim() =="" || name.value.trim() == null){
      messages.push('name is required')
    }

    if( mob.value.trim() =="" || mob.value.trim() == null){
         messages.push("number is required!")
    }

    if( email.value.trim() =="" || email.value.trim() == null){
         messages.push("Email is required!")
    }

    if( mob.value.trim().length < 10 || mob2.value.trim().length < 10){
         messages.push("Please add valid numbrs")
    }
     
    if( mob.value.trim().length > 10 || mob2.value.trim().length > 10){
         messages.push("Please add valid numbrs")
    }

    if( messages.length > 0  ){
      e.preventDefault()
      errorElement.innerText = messages.join(' & ')
      
    }

    })
    


  </script>


<script>
      function cancelOrder( id) {


    Swal.fire({
      title: "Are you sure?",
      text: "You won't be able to revert this!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "Yes, change it!",
      cancelButtonText: "Cancel",
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: "/orderCancel",
                data: {
                    
                    id: id,
                },
                method: "post",
                success: (response) => {
              
            if ((response.remove = true)) {  
                location.reload();
            }
          },
        });
      }
    });
  } 
</script>

<%- include("../user/layouts/user_footer.ejs") %>
